---
title: "[Network] 데이터 링크 계층 : 랜에서 데이터 전송하기"
excerpt: "<!--more-->"
categories:
  - Network
tags:
  - Network
  - 모두의 네트워크
toc: true
toc_sticky: true
toc_label: "[Network] 데이터 링크 계층 : 랜에서 데이터 전송하기"
toc_icon: "bookmark"
---

# 12. 데이터 링크 계층의 역할과 이더넷

**데이터 링크 계층** : 네트워크 장비 간에 신호를 주고 받는 규칙을 정하는 계층
- LAN에서 데이터를 정상적으로 주고 받기 위해 필요한 계층

**이더넷(Ethernet)** : **LAN**에서 데이터를 정상적으로 주고받기 위한 규칙
- 일반적으로 가장 많이 사용되는 규칙
- 허브와 같은 장비에 연결된 컴퓨터와 데이터를 주고받을 때 사용

**허브**
- 약해지거나 파형이 일그러진 전기 신호를 복원
- 해당 전기 신호를 전달받은 포트를 제외한 나머지 모든 포트에도 전달됨 -> **더미허브**
- 허브를 사용하는 랜 환경에서 특정 컴퓨터 한 대에 데이터를 보내려고 해도 다른 모든 컴퓨터에 전기 신호가 전달됨
  - 보내려는 데이터에 **목적지 정보**를 추가하면 목적지 이외의 컴퓨터는 데이터를 무시함
  - 컴퓨터 여러 대가 동시에 데이터를 보내면 데이터 **충돌(collision)** 발생

<img src="/images/network/modu/hub-ignore-rule.png" width="500"/>

**이더넷**
- 여러 컴퓨터가 동시에 데이터를 전송해도 충돌 일어나지 않는 구조
- 데이터 충돌을 막기 위해 **CSMA/CD 방식**을 사용함
  - **CS** : 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 확인하는 규칙
  - **MA** : 케이블에 데이터가 흐르고 있지 않으면 데이터를 보내도 된다는 규칙
  - **CD** : 충돌이 발생하고 있는지 확인하는 규칙
  - **현재 효율이 좋지 않다는 이유로 사용 안함**<br>
  -> **스위치(switch)** 네트워크 장비 사용하면 충돌 일어나지 않음

<img src="/images/network/modu/ethernet-csmacd.png" width="500"/>

# 13. MAC 주소의 구조

**랜 카드**
- 비트열(0과 1)을 전기 신호로 변환함
- **MAC 주소** 번호가 정해져 있음
  - 제조할 때 새겨져서 **물리주소**라고도 함
  - **전 세계에서 유일한 번호**로 할당됨

**MAC 주소**
- **`00-23-AE-D9-7A-9A`** -> **48비트 숫자로 구성**
  - 앞쪽 24비트는 랜 카드를 만든 제조사 번호
  - 뒤쪽 24비트는 제조사가 랜 카드에 붙인 일련번호
  - 앞의 24비트와 뒤의 24비트 모두 정해진 규칙이 있어 중복되지 않음

- OSI 모델에서는 데이터 링크 계층, TCP/IP 모델에서는 네트워크 계층에서 **이더넷 헤더**와 **트레일러**를 붙임

**이더넷 헤더 구조**
- **`목적지 MAC주소(6바이트)`, `출발지 MAC 주소(6바이트)`, `유형(2바이트)`**<br>
-> **총 14바이트로 구성**
- **이더넷 유형(Ethernet type)** : 이더넷으로 전송되는 상위 계층 프로토콜의 종류
  - 프로토콜 종류를 식별하는 번호가 들어감

**트레일러**
- **FCS(Frame Check Sequence)**라고도 함
- 데이터 전송 도중에 오류가 발생하는지 확인하는 용도

**프레임**
- 이더넷 헤더와 트레일러가 추가된 데이터
  - **`프레임 = 이더넷 헤더 + 데이터 + 트레일러`**
- 네트워크를 통해 프레임이 전송됨

## 이더넷 헤더를 이용한 통신

**컴퓨터 1에서 컴퓨터 3으로 데이터 전송과정**

<img src="/images/network/modu/hub-macaddress.png" width="500"/>

- 컴퓨터 1은 이더넷 헤더에 3의 MAC주소(목적지 MAC 주소)와 자신의 MAC 주소(출발지 MAC 주소) 정보를 넣고 데이터를 전송 -> **캡슐화**
  - **데이터 링크 계층**에서 이더넷 헤더와 트레일러를 추가하여 **프레임**을 만듬
  - **물리 계층**에서 이 프레임 비트열을 **전기 신호**로 변환하여 네트워크를 통해 전송 

<img src="/images/network/modu/ethernet-header.png" width="500"/>

- 컴퓨터 1이 보낸 데이터를 1번 포트로 수신하고 2~5번 모든 포트로 전송
- 컴퓨터 2, 4, 5는 목적지 MAC 주소를 체크하고 다르면 데이터를 파기함
- 컴퓨터 3은 목적지 MAC 주소가 일치하여 데이터를 수신함 -> **역캡슐화**
  - **물리 계층**에서 전기 신호로 전송된 데이터를 **비트열**로 변환
  - **데이터 링크 계층**은 이너넷 헤더와 트레일러를 분리함

<img src="/images/network/modu/hub-macaddress-res.png" width="500"/>

# 14. 스위치(switch)의 구조

**스위치**
- 데이터 링크 계층에서 동작하고 **레이어 2 스위치 or 스위칭 허브**라고도 함
- 스위치 내부에 **MAC 주소 테이블(MAC address table)**이 있음

**MAC 주소 테이블**
- 브리지 테이블(bridge table)이라고도 함
- 스위치의 포트 번호와 해당 포트에 연결되어 있는 컴퓨터의 MAC 주소가 등록되는 데이터베이스 

## 스위치 동작 방식

_1._ 스위치 전원을 키면 MAC 주소 테이블에는 아무것도 등록되어 있지 않음<br>
_2._ 컴퓨터에서 목적지 MAC 주소가 추가된 프레임 데이터가 전송되면 MAC 주소 테이블을 확인하고
출발지 MAC 주소가 등록되어 있지 않으면 MAC주소를 포트와 함께 등록함<br>
-> **MAC 주소 학습 기능**

<img src="/images/network/modu/macaddress-learning.png" width="400"/>

_3._ 목적지 MAC 주소가 MAC 주소 테이블에 등록되어 있지 않으면 송신 포트 이외의 모든 포트에
데이터(프레임)이 전송됨 -> **플러딩(flooding)**

<img src="/images/network/modu/macaddress-flooding.png" width="400"/>

_4._ 목적지 MAC 주소가 등록되어 있다면 목적지 컴퓨터에만 데이터 전송됨 -> **MAC 주소 필터링**

<img src="/images/network/modu/macaddress-filtering.png" width="400"/>

# 15. 데이터가 케이블에서 충돌하지 않는 구조

**통신방식**
- **전이중 통신 방식**
  - 데이터의 송수신을 **동시에** 통신하는 방식
  - 데이터 동시에 전송해도 충돌 발생하지 않음
  - ex) 컴퓨터 간에 직접 랜케이블(크로스 케이블)로 연결하는 방식, **스위치**
- **반이중 통신 방식**
  - 회선 하나로 송신과 수신을 **번갈아가면서** 통신하는 방식
  - 데이터 동시에 전송하면 충돌 발생
  - ex) **허브**는 회선 하나를 송신과 수신이 번갈아가면서 사용함

**충돌 도메인(collision domain)**
- 충돌이 발생할 때 그 영향이 미치는 범위
- **허브** 
  - 연결되어 있는 컴퓨터 전체가 하나의 충돌 도메인
- **스위치**
  - 전이중 통신 방식으로 충돌이 일어나지 않음
  - 연결되어 있는 컴퓨터 전체에 영향을 미치지 않음
- 충돌 도메인 관점에서 보면 **스위치**가 허브보다 통신 효율이 좋음

# ARP(Address Resolution Protocol)

- 목적지 컴퓨터의 IP 주소를 이용하여 MAC 주소를 찾기 위한 프로토콜
  - IP 주소를 MAC 주소로 변환하는데 사용 -> **주소 변환 프로토콜**
- 네트워크 계층과 데이터 링크 계층 사이의 변환을 담당하는 프로토콜

## ARP 프로토콜 동작 순서

- 이더넷 프레임을 전송하려면 목적지 컴퓨터의 MAC 주소를 지정해야 함
- **ARP 요청(request)**
  - 출발지 컴퓨터가 IP 주소에 대치되는 목적지 MAC 주소를 알아내기 위해 네트워크에 브로드캐스트 패킷 요청
- **ARP 응답(reply)**
  - ARP 요청에 대해 지정된 IP 주소를 가진 컴퓨터는 MAC 주소를 응답을 보냄
- 이것으로 출발지 컴퓨터는 목적지 MAC 주소를 얻고 이더넷 프레임을 만들 수 있음
- **ARP 테이블(table)**
  - 출발지 컴퓨터는 목적지 MAC 주소와 IP 주소의 매핑 정보를 메모리에 보관함
  - 이후 데이터 통신은 APR 테이블을 참고하여 전송함
  - IP 주소가 변경되면 해당 MAC 주소도 함께 변경되어 제대로 통신 못함
- **ARP 캐시(cache)**
  - 가장 최근에 변환한 IP 주소 - MAC 주소를 보관하고 있는 램(RAM)의 영역
  - 일정 시간이 지나면 ARP 테이블의 정보를 삭제하고 다시 ARP 요청을 함

# 16. 이더넷의 종류와 특징

- 이더넷은 케이블 종류와 통신 속도에 따라 다양한 규격으로 분류됨
- **`10 BASE-T`** -> **`통신속도, 전송방식, 케이블`**
  - 10은 Mbps 단위인 **통신속도**
  - BASE는 BASEBAND **전송방식**
    - BASEBAND : 펄스 신호에 의한 디지털 전송 방식
  - T는 **케이블 종류**

**케이블 종류**
- **동축케이블**
  - 전송방식 뒤에 **하이픈(-)이 없음**
  - 숫자는 **케이블의 최대 길이 100미터 단위**로 표시함
    - ex) 10BASE5 -> 5는 500미터를 의미함
- **UTP케이블**
  - 전송방식 뒤에 **하이픈(-)이 있음**

# reference

> [모두의 네트워크](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=151491282)